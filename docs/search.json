[
  {
    "objectID": "index.html#two-methods",
    "href": "index.html#two-methods",
    "title": "Estimate the risk of outbreaks",
    "section": "Two methods",
    "text": "Two methods\n\nProbability generating functions\nFirst-step analysis"
  },
  {
    "objectID": "index.html#compartmental-models",
    "href": "index.html#compartmental-models",
    "title": "Estimate the risk of outbreaks",
    "section": "Compartmental models",
    "text": "Compartmental models\nConsider the Susceptible-Infectious-Removed (SIR) model\n\n\n\n\nflowchart LR\n  S[\"S(t)\"] --βI/N--> I[\"I(t)\"]\n  I --γ--> R[\"R(t)\"]\n\n\n\n\n\n\n\n\nIn the deterministic version\n\n\\(\\beta\\): infection rate\n\\(\\gamma\\): removal rate\n\nRandomness in contacts between individuals is important for determining whether or not a major outbreak occurs \\(\\Rightarrow\\) inappropriate for modelling the start of an outbreak"
  },
  {
    "objectID": "index.html#stochastic-sir-models",
    "href": "index.html#stochastic-sir-models",
    "title": "Estimate the risk of outbreaks",
    "section": "Stochastic SIR models",
    "text": "Stochastic SIR models\n\n\n\n\nflowchart LR\n  S[\"S(t)\"] --βI/N--> I[\"I(t)\"]\n  I --γ--> R[\"R(t)\"]\n\n\n\n\n\n\n\n\nGillespie algorithm\n2 possible events:\n\n\\(\\mathbb{P}\\)(infection event) = \\(\\frac{\\beta \\frac{I(t)}{N} S(t)}{\\beta \\frac{I(t)}{N} S(t) + \\gamma I(t)}\\)\n\\(\\mathbb{P}\\)(removal event) = \\(\\frac{\\gamma I(t)}{\\beta \\frac{I(t)}{N} S(t) + \\gamma I(t)}\\)"
  },
  {
    "objectID": "index.html#stochastic-sir-models-1",
    "href": "index.html#stochastic-sir-models-1",
    "title": "Estimate the risk of outbreaks",
    "section": "Stochastic SIR models (1)",
    "text": "Stochastic SIR models (1)\n\n\n\n\nflowchart LR\n  S[\"S(t)\"] --βI/N--> I[\"I(t)\"]\n  I --γ--> R[\"R(t)\"]\n\n\n\n\n\n\n\n\nGillespie algorithm\n2 possible events:\n\n\\(\\mathbb{P}\\text{(infection event)} = \\frac{\\beta \\frac{I(t)}{N} S(t)}{\\beta \\frac{I(t)}{N} S(t) + \\gamma I(t)}\\)\n\\(\\mathbb{P}\\text{(removal event)} = \\frac{\\gamma I(t)}{\\beta \\frac{I(t)}{N} S(t) + \\gamma I(t)}\\)"
  },
  {
    "objectID": "index.html#stochastic-sir-models-2",
    "href": "index.html#stochastic-sir-models-2",
    "title": "Estimate the risk of outbreaks",
    "section": "Stochastic SIR models (2)",
    "text": "Stochastic SIR models (2)\nEarly stage:\n\\(I(t) = 1\\), \\(S(t) \\approx N\\)\n\\(\\mathbb{P}\\text{(infection event)} = \\frac{\\beta \\frac {I(t)} {N} S(t)}{\\beta \\frac {I(t)} {N} S(t) + \\gamma I(t)} \\approx \\frac {\\beta} {\\beta + \\gamma}\\)\n\\(\\mathbb{P}\\text{(removal event)} = \\frac {\\gamma I(t)} {\\beta \\frac {I(t)} {N} S(t) + \\gamma I(t)} \\approx \\frac {\\gamma} {\\beta + \\gamma}\\)"
  },
  {
    "objectID": "index.html#si_nr",
    "href": "index.html#si_nr",
    "title": "Estimate the risk of outbreaks",
    "section": "\\(SI_{n}R\\)",
    "text": "\\(SI_{n}R\\)\n\n\nCode\nsolve_q <- function(R0, n){\n  # define the equation\n  f <- function(q) (1 / ((R0 / n) + 1 - q * (R0 / n))^n) - q\n  \n  # use uniroot function to find the root of the equation\n  result <- uniroot(f, lower=0, upper=0.999)$root\n  \n  return(result)\n}\n\nR0 <- 2\nn <- seq(0.001, 5, 0.001)\nq <- numeric(length(n))\n\nfor (i in 1:length(n)){\n  q[i] <- solve_q(R0, n[i])\n}\n\nplot(n, 1-q, type=\"l\", xlab=\"n\", ylab=\"1-q\", \n     xlim = c(0, 5), ylim = c(0, 0.8))"
  },
  {
    "objectID": "index.html#based-on-these-papers",
    "href": "index.html#based-on-these-papers",
    "title": "Estimate the risk of outbreaks",
    "section": "Based on these papers",
    "text": "Based on these papers\n\nSouthall E, Ogi-Gittins Z, Kaye AR, Hart WS, Lovell-Read FA, Thompson RN. A practical guide to mathematical methods for estimating infectious disease outbreak risks. Journal of Theoretical Biology. 2023 Jan 20:111417. https://doi.org/10.1016/j.jtbi.2023.111417\nSachak-Patwa R, Byrne HM, Dyson L, Thompson RN. The risk of SARS-CoV-2 outbreaks in low prevalence settings following the removal of travel restrictions. Communications Medicine. 2021 Oct 15;1(1):39. https://doi.org/10.1038/s43856-021-00038-8"
  },
  {
    "objectID": "index.html#instantaneous-outbreak-risk-ior",
    "href": "index.html#instantaneous-outbreak-risk-ior",
    "title": "Estimate the risk of outbreaks",
    "section": "Instantaneous Outbreak Risk (IOR)",
    "text": "Instantaneous Outbreak Risk (IOR)\nThe risk that an imported case initiates an outbreak as opposed to the virus simply fading out, under the assumption that pathogen transmissibility is fixed at its value when the imported case enters the population"
  },
  {
    "objectID": "index.html#case-outbreak-risk-cor",
    "href": "index.html#case-outbreak-risk-cor",
    "title": "Estimate the risk of outbreaks",
    "section": "Case Outbreak Risk (COR)",
    "text": "Case Outbreak Risk (COR)"
  },
  {
    "objectID": "index.html#simulated-outbreak-risk-sor",
    "href": "index.html#simulated-outbreak-risk-sor",
    "title": "Estimate the risk of outbreaks",
    "section": "Simulated Outbreak Risk (SOR)",
    "text": "Simulated Outbreak Risk (SOR)\nSimulating the stochastic model 10,000 times starting from 1 infected individual\nSOR = the proportion of simulations in which the number of infected hosts exceeds a pre-defined threshold value (e.g. 100 cases)"
  },
  {
    "objectID": "index.html#numerical-outbreak-risk-nor",
    "href": "index.html#numerical-outbreak-risk-nor",
    "title": "Estimate the risk of outbreaks",
    "section": "Numerical Outbreak Risk (NOR)",
    "text": "Numerical Outbreak Risk (NOR)"
  },
  {
    "objectID": "index.html#deterministic-sir-models",
    "href": "index.html#deterministic-sir-models",
    "title": "Estimate the risk of outbreaks",
    "section": "Deterministic SIR models",
    "text": "Deterministic SIR models\n\n\n\n\nflowchart LR\n  S[\"S(t)\"] --βI/N--> I[\"I(t)\"]\n  I --γ--> R[\"R(t)\"]\n\n\n\n\n\n\n\n\n\n\\(\\beta\\): infection rate\n\\(\\gamma\\): removal rate"
  },
  {
    "objectID": "index.html#deterministic-sir-models-1",
    "href": "index.html#deterministic-sir-models-1",
    "title": "Estimate the risk of outbreaks",
    "section": "Deterministic SIR models",
    "text": "Deterministic SIR models\nRandomness in contacts between individuals is important for determining whether or not a major outbreak occurs \\(\\Rightarrow\\) inappropriate for modelling the start of an outbreak"
  },
  {
    "objectID": "index.html#extinction-probability",
    "href": "index.html#extinction-probability",
    "title": "Estimate the risk of outbreaks",
    "section": "Extinction probability",
    "text": "Extinction probability\n\\[q_n = \\mathbb{P}\\text{(extinct by generation n)} = \\mathbb{P}(Z_n = 0)\\]\n\\[q = q_\\infty = \\mathbb{P}\\text{(ultimate extinction)} = \\mathbb{P}(\\lim_{n\\to\\infty} Z_n) = \\lim_{n\\to\\infty}\\mathbb{P}(Z_n) = \\lim_{n\\to\\infty} q_n\\]\nTheorem\nLet q be the probability of ultimate extinction. Then q is the smallest non-negative solution of the equation \\(G(q) = q\\) (or the fixed point)."
  },
  {
    "objectID": "index.html#why-gq-q-1",
    "href": "index.html#why-gq-q-1",
    "title": "Estimate the risk of outbreaks",
    "section": "Why \\(G(q) = q\\)? (1)",
    "text": "Why \\(G(q) = q\\)? (1)\nLemma: Let \\(q_n = \\mathbb{P}(Z_n = 0)\\) (probability of extinction by generation n). Then \\(q_n = G(q_{n - 1})\\)\nProof:\n\\(G_n(s)\\) is the PGF of \\(Z_n\\), then \\(G_n(0) = \\mathbb{P}(Z_n = 0)\\). So \\(q_n = \\mathbb{P}(Z_n = 0) = G_n(0)\\). Similarly, \\(q_{n - 1} = \\mathbb{P}(Z_{n - 1} = 0) = G_{n - 1}(0)\\)\nNow \\(G_n(0) = \\underbrace{G(G(G(...G}_\\text{n times}(0)...))) = G(G_{n - 1}(0))\\)\nBecause \\(q_{n - 1} = G_{n - 1}(0)\\)\nSo \\(q_n = G_n(0) = G(G_{n - 1}(0)) = G(q_{n - 1})\\)"
  },
  {
    "objectID": "index.html#why-gq-q-2",
    "href": "index.html#why-gq-q-2",
    "title": "Estimate the risk of outbreaks",
    "section": "Why \\(G(q) = q\\)? (2)",
    "text": "Why \\(G(q) = q\\)? (2)\nSo \\(q_n = \\mathbb{P}(Z_n = 0) = G_n(0)\\). Similarly, \\(q_{n - 1} = \\mathbb{P}(Z_{n - 1} = 0) = G_{n - 1}(0)\\)\nNow \\(G_n(0) = \\underbrace{G(G(G(...G}_\\text{n times}(0)...))) = G(G_{n - 1}(0))\\)\nBecause \\(q_{n - 1} = G_{n - 1}(0)\\)\nSo \\(q_n = G_n(0) = G(G_{n - 1}(0)) = G(q_{n - 1})\\)"
  },
  {
    "objectID": "index.html#author",
    "href": "index.html#author",
    "title": "Estimate the risk of outbreaks",
    "section": "Author",
    "text": "Author\n\n\n\n\n\n\n\nRobin Thompson\nAssociate Professor of Applied Mathematics\nMathematics Institute, University of Warwick\nPhD in Mathematical Epidemiology, University of Cambridge"
  },
  {
    "objectID": "index.html#acknowledgements",
    "href": "index.html#acknowledgements",
    "title": "Estimate the risk of outbreaks",
    "section": "Acknowledgements",
    "text": "Acknowledgements\nSomya Mehra: for very intuitive explanation of stochastic processes"
  },
  {
    "objectID": "index.html#branching-process",
    "href": "index.html#branching-process",
    "title": "Estimate the risk of outbreaks",
    "section": "Branching process",
    "text": "Branching process"
  },
  {
    "objectID": "index.html#galton-watson-branching-process",
    "href": "index.html#galton-watson-branching-process",
    "title": "Estimate the risk of outbreaks",
    "section": "Galton-Watson branching process",
    "text": "Galton-Watson branching process\n\n\n\n\n\n\n\nIgnore the precise times at which infections occur\nInfections can be separated into discrete generations\nAll infections generated by a specific individual appear in the same generation."
  },
  {
    "objectID": "index.html#galton-watson-branching-process-1",
    "href": "index.html#galton-watson-branching-process-1",
    "title": "Estimate the risk of outbreaks",
    "section": "Galton-Watson branching process (1)",
    "text": "Galton-Watson branching process (1)\nThe early outbreak can be approximated as a branching process:\n\nEach infected individual generates a number of new infections that is drawn from the offspring distribution\nAssumption: All infected cases independently generate secondary cases (independently draws from the offspring distribution)\nThe offspring distribution is geometric distribution (explained above)"
  },
  {
    "objectID": "index.html#galton-watson-branching-process-2",
    "href": "index.html#galton-watson-branching-process-2",
    "title": "Estimate the risk of outbreaks",
    "section": "Galton-Watson branching process (2)",
    "text": "Galton-Watson branching process (2)\n\n\n\n\n\n\n\nIgnore the precise times at which infections occur\nInfections can be separated into discrete generations\nAll infections generated by a specific individual appear in the same generation."
  },
  {
    "objectID": "index.html#compartmental-outbreak-models-1",
    "href": "index.html#compartmental-outbreak-models-1",
    "title": "Estimate the risk of outbreaks",
    "section": "Compartmental outbreak models (1)",
    "text": "Compartmental outbreak models (1)\n\n\n\n\nflowchart LR\n  S[\"S(t)\"] --βI/N--> I[\"I(t)\"]\n  I --γ--> R[\"R(t)\"]\n\n\n\n\n\n\n\n\n\n\\(\\beta\\): infection rate\n\\(\\gamma\\): removal rate"
  },
  {
    "objectID": "index.html#compartmental-outbreak-models-2",
    "href": "index.html#compartmental-outbreak-models-2",
    "title": "Estimate the risk of outbreaks",
    "section": "Compartmental outbreak models (2)",
    "text": "Compartmental outbreak models (2)\n\nOne contact can lead to infection or not by randomness\nDeterministic model is inappropriate\nInstead, use stochastic model"
  },
  {
    "objectID": "index.html#stochastic-sir-models-3",
    "href": "index.html#stochastic-sir-models-3",
    "title": "Estimate the risk of outbreaks",
    "section": "Stochastic SIR models (3)",
    "text": "Stochastic SIR models (3)\nProbability that 1 infected host generates k infections is:\n\\[\\mathbb{P}(X = k) = \\left( \\frac{\\beta}{\\beta + \\gamma} \\right)^k \\times \\frac{\\gamma}{\\beta + \\gamma}\\]\n\nFirst generate k infections\nThen be removed\nThe number of failures prior to the first success\nA geometric distribution with “success probability” \\(\\frac {\\gamma} {\\beta + \\gamma}\\)"
  },
  {
    "objectID": "index.html#stochastic-sir-models-4",
    "href": "index.html#stochastic-sir-models-4",
    "title": "Estimate the risk of outbreaks",
    "section": "Stochastic SIR models (4)",
    "text": "Stochastic SIR models (4)\nLet X ~ Geo(p)\n\\[G_X(s) = \\mathbb{E}(s^X) = \\]\n\\(1 + r + r^2 + r^3 + ... = \\sum_{x=0}^{\\infty} r^x = \\frac {1} {1 - r}\\) with \\(|r| < 1\\)\nProve this:\n\\(S = 1 + r + r^2 + r^3 + ...\\)\n\\(rS = r + r^2 + r^3 + r^4 + ...\\)\n\\(\\Rightarrow S - rS = 1 \\Leftrightarrow S(1 - r) = 1 \\Leftrightarrow S = \\frac {1} {1 - r}\\)"
  },
  {
    "objectID": "index.html#galton-watson-branching-process-3",
    "href": "index.html#galton-watson-branching-process-3",
    "title": "Estimate the risk of outbreaks",
    "section": "Galton-Watson branching process (3)",
    "text": "Galton-Watson branching process (3)\n\n\nStart with 1 individual at generation n = 0.\nEach individual lives 1 generation, has \\(Y\\) offspring, and dies.\n\\(Y\\) takes values 0, 1, 2, …, and the probability of producing \\(k\\) offspring is \\(\\mathbb{P}(Y = k) = p_k\\)."
  },
  {
    "objectID": "index.html#methods-for-estimating-the-probability-of-a-major-outbreak",
    "href": "index.html#methods-for-estimating-the-probability-of-a-major-outbreak",
    "title": "Estimate the risk of outbreaks",
    "section": "Methods for estimating the probability of a major outbreak",
    "text": "Methods for estimating the probability of a major outbreak\nTwo methods:\n\nProbability generating functions\nFirst-step analysis"
  },
  {
    "objectID": "index.html#probability-generating-functions-1",
    "href": "index.html#probability-generating-functions-1",
    "title": "Estimate the risk of outbreaks",
    "section": "Probability generating functions (1)",
    "text": "Probability generating functions (1)\nThe early outbreak can be approximated as a branching process:\n\nEach infected individual generates a number of new infections that is drawn from the offspring distribution\nAssumption: All infected cases independently generate secondary cases (independently draws from the offspring distribution)\nThe offspring distribution is geometric distribution (explained above)"
  },
  {
    "objectID": "index.html#probability-generating-functions-2",
    "href": "index.html#probability-generating-functions-2",
    "title": "Estimate the risk of outbreaks",
    "section": "Probability generating functions (2)",
    "text": "Probability generating functions (2)\nProbability generating function (PGF) is useful to deal with sums and limits of discrete random variables.\n\\[G_X(s) = \\mathbb{E}(s^X) = \\sum_{x = 0}^\\infty s^x \\mathbb{P}(X = x)\\]\n\\[G_X(s) = s^0 \\mathbb{P}(X = 0) + s^1 \\mathbb{P}(X = 1) + s^2 \\mathbb{P}(X = 2) + ...\\]\nPGF is a function that can generate all probabilities of the distribution."
  },
  {
    "objectID": "index.html#probability-generating-functions-3",
    "href": "index.html#probability-generating-functions-3",
    "title": "Estimate the risk of outbreaks",
    "section": "Probability generating functions (3)",
    "text": "Probability generating functions (3)\nPGF can generate all probabilities of the distribution.\nLet \\(p_0 = \\mathbb{P}(X = 0)\\), \\(p_1 = \\mathbb{P}(X = 1)\\)…\n\\[G_X(s) = s^0 p_0 + s^1 p_1 + s^2 p_2 + ...\\]\nIf \\(s = 0\\), \\(G_X(s) = G(0) = 0^0 p_0 + 0^1 p_1 + 0^2 p_2 + ...\\)\nBecause"
  },
  {
    "objectID": "index.html#calculate-probabilities-with-pgf-1",
    "href": "index.html#calculate-probabilities-with-pgf-1",
    "title": "Estimate the risk of outbreaks",
    "section": "Calculate probabilities with PGF (1)",
    "text": "Calculate probabilities with PGF (1)\nLet \\(p_0 = \\mathbb{P}(X = 0)\\), \\(p_1 = \\mathbb{P}(X = 1)\\)…\n\\[G_X(s) = s^0 p_0 + s^1 p_1 + s^2 p_2 + s^3 p_3 + s^4 p_4 ...\\]\nIf \\(s = 0\\), then \\(G_X(0) = 0^0 p_0 + 0^1 p_1 + 0^2 p_2 + 0^3 p_3 + ...\\)\nBecause \\(0^0 = 1\\) and \\(0^1 = 0^2 = 0^3 = ... = 0\\)\nTherefore \\(G(0) = p_0\\)"
  },
  {
    "objectID": "index.html#calculate-probabilities-with-pgf-2",
    "href": "index.html#calculate-probabilities-with-pgf-2",
    "title": "Estimate the risk of outbreaks",
    "section": "Calculate probabilities with PGF (2)",
    "text": "Calculate probabilities with PGF (2)\n\\[G_X(s) = s^0 p_0 + s^1 p_1 + s^2 p_2 + s^3 p_3 + s^4 p_4 ...\\]\nFirst derivative: \\(G'_X(s) = p_1 + 2 p_2 s + 3 p_3 s^2 + 4 p_4 s^3 ...\\)\nIf \\(s = 0\\), then \\(G'_X(0) = p_1\\)\nSecond derivative: \\(G''_X(s) = 2 p_2 + 6 p_3 s + 12 p_4 s^2 ...\\)\nIf \\(s = 0\\), then \\(G''_X(0) = 2 p_2\\) or \\(p_2 = \\frac{G''_X(0)}{2}\\)"
  },
  {
    "objectID": "index.html#same-corresponding-author",
    "href": "index.html#same-corresponding-author",
    "title": "Estimate the risk of outbreaks",
    "section": "Same corresponding author",
    "text": "Same corresponding author\n\n\n\n\n\n\n\nRobin Thompson\nAssociate Professor of Applied Mathematics\nMathematics Institute, University of Warwick\nPhD in Mathematical Epidemiology, University of Cambridge"
  },
  {
    "objectID": "index.html#pgf-of-geometric-distribution",
    "href": "index.html#pgf-of-geometric-distribution",
    "title": "Estimate the risk of outbreaks",
    "section": "PGF of geometric distribution",
    "text": "PGF of geometric distribution"
  },
  {
    "objectID": "index.html#pgf-of-geometric-distribution-1",
    "href": "index.html#pgf-of-geometric-distribution-1",
    "title": "Estimate the risk of outbreaks",
    "section": "PGF of geometric distribution (1)",
    "text": "PGF of geometric distribution (1)\nIn the SIR model, the offspring distribution is a geometric distribution with “success probability” \\(\\frac {\\gamma} {\\beta + \\gamma}\\)\n\\[G_X(s) = \\mathbb{E}(s^X) = \\sum_{x = 0}^\\infty s^x \\mathbb{P}(X = x)\\]\nLet \\(X \\sim \\text{Geometric(p)}\\) with \\(p\\) is the success probability\nThen the PMF \\(\\mathbb{P}(X = x) = (1 - p)^xp\\) (having \\(x\\) failures before success)"
  },
  {
    "objectID": "index.html#pgf-of-geometric-distribution-2",
    "href": "index.html#pgf-of-geometric-distribution-2",
    "title": "Estimate the risk of outbreaks",
    "section": "PGF of geometric distribution (2)",
    "text": "PGF of geometric distribution (2)\n\\(G_X(s) = \\mathbb{E}(s^X) = \\sum_{x = 0}^\\infty s^x \\mathbb{P}(X = x)\\)\n\\(= \\sum_{x = 0}^\\infty s^x (1 - p)^x p = p \\sum_{x = 0}^\\infty [s(1 - p)]^x\\)\n\\(= p\\{[s(1 - p)]^0 + [s(1 - p)]^1 + [s(1 - p)]^2 + ...\\}\\)\n\\(= p[1 + s(1 - p) + [s(1 - p)]^2 + ...]\\)"
  },
  {
    "objectID": "index.html#pgf-of-geometric-distribution-3",
    "href": "index.html#pgf-of-geometric-distribution-3",
    "title": "Estimate the risk of outbreaks",
    "section": "PGF of geometric distribution (3)",
    "text": "PGF of geometric distribution (3)\n\\(G_X(s) = p[1 + s(1 - p) + [s(1 - p)]^2 + ...]\\)\nWe have: \\(1 + r + r^2 + r^3 + ... = \\frac {1} {1 - r}\\) with \\(|r| < 1\\)\n\n\n\n\\(A = 1 + r + r^2 + r^3 + ...\\)\n\\(rA = r + r^2 + r^3 + r^4 + ...\\)\n\\(\\Rightarrow A - rA = 1 \\Leftrightarrow A(1 - r) = 1 \\Leftrightarrow A = \\frac {1} {1 - r}\\)\n\n\n\nHere \\(r = s(1 - p) \\Rightarrow G_X(s) = \\frac{p}{1 - s(1 - p)}\\)"
  },
  {
    "objectID": "index.html#prove-this",
    "href": "index.html#prove-this",
    "title": "Estimate the risk of outbreaks",
    "section": "Prove this",
    "text": "Prove this\n\\(S = 1 + r + r^2 + r^3 + ...\\)\n\\(rS = r + r^2 + r^3 + r^4 + ...\\)\n\\(\\Rightarrow S - rS = 1 \\Leftrightarrow S(1 - r) = 1 \\Leftrightarrow S = \\frac {1} {1 - r}\\)\n:::"
  },
  {
    "objectID": "index.html#extinct-by-generation-n",
    "href": "index.html#extinct-by-generation-n",
    "title": "Estimate the risk of outbreaks",
    "section": "Extinct by generation n",
    "text": "Extinct by generation n\nLet \\(Z_n\\) be the size of generation n.\nA branching process extinct by generation n when there is 0 offspring at generation n.\nLet \\(E_n\\) be the event that there is 0 offspring at generation n, or \\(E_n = \\{Z_n = 0\\}\\)\n\\[\\mathbb{P}\\text{(extinct by generation n)} = \\mathbb{P}(E_n) = \\mathbb{P}(Z_n = 0)\\]"
  },
  {
    "objectID": "index.html#ultimate-extinction-1",
    "href": "index.html#ultimate-extinction-1",
    "title": "Estimate the risk of outbreaks",
    "section": "Ultimate extinction (1)",
    "text": "Ultimate extinction (1)\nUltimate extinction is probability that the population will be extinct by generation n, for any value of n. This is the probability of extinct by gen 0 or gen 1 or gen 2…\n\\[\\mathbb{P}\\text{(ultimate extinction)} = \\mathbb{P} \\left( \\bigcup_{n = 0}^\\infty E_n \\right)\\]"
  },
  {
    "objectID": "index.html#ultimate-extinction-2",
    "href": "index.html#ultimate-extinction-2",
    "title": "Estimate the risk of outbreaks",
    "section": "Ultimate extinction (2)",
    "text": "Ultimate extinction (2)\n\n\n\n\n\n\n\\(E_0 \\subseteq E_1 \\subseteq E_2 \\subseteq E_3\\)… (\\(E_0\\) is a subset of \\(E_1\\) and so on). We obtain the union when reach generation \\(\\infty\\)"
  },
  {
    "objectID": "index.html#ultimate-extinction-2-1",
    "href": "index.html#ultimate-extinction-2-1",
    "title": "Estimate the risk of outbreaks",
    "section": "Ultimate extinction (2)",
    "text": "Ultimate extinction (2)\n\n\n\nLet \\(f(x) = x^3\\), \\(g(x) = x + 2\\), find \\(lim_{x \\to 3} f(g(x))\\)\nThere are two ways to solve this:\n\nPlug \\(g(x) = x + 2\\) inside of \\(f(x)\\)\n\n\\(f(g(x)) = (x + 2)^3\\)\n\\(lim_{x \\to 3} (x + 2)^3 = 5^3 = 125\\)\n\nBecause \\(f(x)\\) is a continuous function, we can put the \\(lim\\) inside of \\(f(x)\\)\n\n\\(lim_{x \\to 3} f(g(x)) = f[lim_{x \\to 3} g(x)] = f[lim_{x \\to 3} (x + 2)] = f(5) = 125\\)\n\n\n\nTheorem\nLet q be the probability of ultimate extinction. Then q is the smallest non-negative solution of the equation \\(G(q) = q\\) (or the fixed point)."
  },
  {
    "objectID": "index.html#ultimate-extinction-3",
    "href": "index.html#ultimate-extinction-3",
    "title": "Estimate the risk of outbreaks",
    "section": "Ultimate extinction (3)",
    "text": "Ultimate extinction (3)\n\\[\\mathbb{P}\\text{(ultimate extinction)} = \\mathbb{P}(\\lim_{n\\to\\infty} E_n)\\]\nBy the Continuity Theorem: we can take the limit outside\n\\[\\mathbb{P}(\\lim_{n\\to\\infty} E_n) = \\lim_{n\\to\\infty}\\mathbb{P}(E_n) = \\lim_{n\\to\\infty}\\mathbb{P}(Z_n = 0)\\]\nSo ultimate extinction is the limit of event “0 offspring at generation n”, when \\(n \\to \\infty\\)."
  },
  {
    "objectID": "index.html#prove-taking-the-limit-out",
    "href": "index.html#prove-taking-the-limit-out",
    "title": "Estimate the risk of outbreaks",
    "section": "Prove: Taking the limit out",
    "text": "Prove: Taking the limit out\n\n\n\nLet \\(f(x) = x^3\\), \\(g(x) = x + 2\\), find \\(lim_{x \\to 3} f(g(x))\\)\nThere are two ways to solve this:\n\nPlug \\(g(x) = x + 2\\) inside of \\(f(x)\\)\n\n\\(f(g(x)) = (x + 2)^3\\)\n\\(lim_{x \\to 3} (x + 2)^3 = 5^3 = 125\\)\n\nBecause \\(f(x)\\) is a continuous function, we can put the \\(lim\\) inside of \\(f(x)\\)\n\n\\(lim_{x \\to 3} f(g(x)) = f[lim_{x \\to 3} g(x)] = f[lim_{x \\to 3} (x + 2)] = f(5) = 125\\)"
  },
  {
    "objectID": "index.html#ultimate-extinction-4",
    "href": "index.html#ultimate-extinction-4",
    "title": "Estimate the risk of outbreaks",
    "section": "Ultimate extinction (4)",
    "text": "Ultimate extinction (4)\nIf \\(G_{Z_n}(s)\\) is the PGF of \\(Z_n\\) (number of offspring at generation n).\n\\(G_{Z_n}(s) = s^0 \\mathbb{P}(Z_n = 0) + s^1 \\mathbb{P}(Z_n = 1) + s^2 \\mathbb{P}(Z_n = 2)..\\)\nWe have \\(G_{Z_n}(0) = \\mathbb{P}(Z_n = 0)\\).\nFor ease of notation, we write \\(G_{Z_n}(0) = G_n(0)\\).\nSo:\n\\[\\mathbb{P}\\text{(ultimate extinction)} = \\lim_{n\\to\\infty} G_n(0)\\]"
  },
  {
    "objectID": "index.html#ultimate-extinction-5",
    "href": "index.html#ultimate-extinction-5",
    "title": "Estimate the risk of outbreaks",
    "section": "Ultimate extinction (5)",
    "text": "Ultimate extinction (5)\nTheorem\nThe ultimate extinction probability q is the smallest non-negative solution of the equation \\(G_X(q) = q\\) (or the fixed point). \\(G_X(q)\\) is the probability generating function."
  },
  {
    "objectID": "index.html#why-gq-q",
    "href": "index.html#why-gq-q",
    "title": "Estimate the risk of outbreaks",
    "section": "Why \\(G(q) = q\\)?",
    "text": "Why \\(G(q) = q\\)?\nLemma: Let \\(q_n = \\mathbb{P}(Z_n = 0)\\) (probability of extinction by generation n). Then \\(q_n = G(q_{n - 1})\\)\nProof:\n\\(G_n(s)\\) is the PGF of \\(Z_n\\), then \\(G_n(0) = \\mathbb{P}(Z_n = 0)\\). So \\(q_n = \\mathbb{P}(Z_n = 0) = G_n(0)\\). Similarly, \\(q_{n - 1} = \\mathbb{P}(Z_{n - 1} = 0) = G_{n - 1}(0)\\)\nNow \\(G_n(0) = \\underbrace{G(G(G(...G}_\\text{n times}(0)...))) = G(G_{n - 1}(0))\\)\nBecause \\(q_{n - 1} = G_{n - 1}(0)\\)\nSo \\(q_n = G_n(0) = G(G_{n - 1}(0)) = G(q_{n - 1})\\)"
  },
  {
    "objectID": "index.html#ultimate-extinction-of-sir-models-1",
    "href": "index.html#ultimate-extinction-of-sir-models-1",
    "title": "Estimate the risk of outbreaks",
    "section": "Ultimate extinction of SIR models (1)",
    "text": "Ultimate extinction of SIR models (1)\nIn the SIR model, the offspring distribution is a geometric distribution with “success probability” \\(\\frac {\\gamma} {\\beta + \\gamma}\\)\nAlso for SIR model: \\(R_0 = \\frac{\\beta}{\\gamma} \\Rightarrow \\gamma = \\frac{\\beta}{R_0}\\)\nPlug \\(\\gamma = \\frac{\\beta}{R_0}\\) to the success probability\n\\(\\frac {\\gamma} {\\beta + \\gamma} = \\frac{\\frac{\\beta}{R_0}}{\\beta + \\frac{\\beta}{R_0}} = \\frac{\\frac{\\beta}{R_0}}{\\frac{\\beta(R_0 + 1)}{R_0}} = \\frac{1}{R_0 + 1}\\)"
  },
  {
    "objectID": "index.html#ultimate-extinction-of-sir-models-2",
    "href": "index.html#ultimate-extinction-of-sir-models-2",
    "title": "Estimate the risk of outbreaks",
    "section": "Ultimate extinction of SIR models (2)",
    "text": "Ultimate extinction of SIR models (2)\nNow the “success probability” is \\(p = \\frac{1}{R_0 + 1}\\)\nThe PGF of geometric distribution is \\(G_X(s) = \\frac{p}{1 - s(1 - p)}\\)\n\\(G_X(s) = \\frac{\\frac{1}{R_0 + 1}}{1 - s \\left( 1 - \\frac{1}{R_0 + 1} \\right)} = \\frac{\\frac{1}{R_0 + 1}}{\\frac{R_0 + 1 - s(R_0 + 1 - 1)}{R_0 + 1}} = \\frac{1}{R_0 + 1 - sR_0}\\)\nUltimate extinction probability \\(q\\) is the solution of \\(G_X(q) = q\\)\n\\(\\Leftrightarrow \\frac{1}{R_0 + 1 - qR_0} = q\\)\n\\(\\Leftrightarrow R_0q^2 - (R_0 + 1)q + 1 = 0\\)"
  },
  {
    "objectID": "index.html#ultimate-extinction-of-sir-models-3",
    "href": "index.html#ultimate-extinction-of-sir-models-3",
    "title": "Estimate the risk of outbreaks",
    "section": "Ultimate extinction of SIR models (3)",
    "text": "Ultimate extinction of SIR models (3)\n\\[R_0q^2 - (R_0 + 1)q + 1 = 0\\]\nThe solutions are \\(q = 1\\) and \\(q = \\frac{1}{R_0}\\)\nThe risk of outbreaks is:\n\\[1 - \\mathbb{P}\\text{(ultimate extinction)} = 1 - q = 1 - \\frac{1}{R_0}\\]"
  },
  {
    "objectID": "index.html#galton-watson-branching-process-4",
    "href": "index.html#galton-watson-branching-process-4",
    "title": "Estimate the risk of outbreaks",
    "section": "Galton-Watson branching process (4)",
    "text": "Galton-Watson branching process (4)\n\n\nAll individuals reproduce independently.\nIndividuals 1, 2, …, n have family sizes \\(Y_1\\), \\(Y_2\\), …, \\(Y_n\\), where each \\(Y_i\\) has the same offspring distribution as \\(Y\\)."
  },
  {
    "objectID": "index.html#probability-generating-function",
    "href": "index.html#probability-generating-function",
    "title": "Estimate the risk of outbreaks",
    "section": "Probability generating function",
    "text": "Probability generating function\n\nPGF is a function that can generate all probabilities of the distribution.\n\\[G_X(s) = \\mathbb{E}(s^X) = \\sum_{x = 0}^\\infty s^x \\mathbb{P}(X = x)\\]\n\\[G_X(s) = s^0 \\mathbb{P}(X = 0) + s^1 \\mathbb{P}(X = 1) + s^2 \\mathbb{P}(X = 2) + ...\\]"
  },
  {
    "objectID": "index.html#the-pgf-method",
    "href": "index.html#the-pgf-method",
    "title": "Estimate the risk of outbreaks",
    "section": "The PGF method",
    "text": "The PGF method\n\nDefine your stochastic model / branching process\nDerive the offspring distribution\nGet the PGF \\(G_X(s)\\) of the offspring distribution\nSolve \\(G_X(q) = q\\) and get the ultimate extinction probability \\(q\\)\nThe risk of outbreaks is \\(1 - q\\)"
  },
  {
    "objectID": "index.html#summary-the-pgf-method",
    "href": "index.html#summary-the-pgf-method",
    "title": "Estimate the risk of outbreaks",
    "section": "Summary: the PGF method",
    "text": "Summary: the PGF method\n\nDefine your stochastic model / branching process\nDerive the offspring distribution\nGet the PGF \\(G_X(s)\\) of the offspring distribution\nSolve \\(G_X(q) = q\\) for the ultimate extinction probability \\(q\\)\nThe risk of outbreaks is \\(1 - q\\)"
  },
  {
    "objectID": "index.html#first-step-analysis-1",
    "href": "index.html#first-step-analysis-1",
    "title": "Estimate the risk of outbreaks",
    "section": "First-step analysis (1)",
    "text": "First-step analysis (1)\nConditioning on the first event.\n\nThe first event can only be either (i) an infection or (ii) a removal."
  },
  {
    "objectID": "index.html#first-step-analysis-2",
    "href": "index.html#first-step-analysis-2",
    "title": "Estimate the risk of outbreaks",
    "section": "First-step analysis (2)",
    "text": "First-step analysis (2)\n\\(\\mathbb{P}\\text{(no outbreak)} = \\mathbb{P}(\\text{no outbreak} \\cap \\text{1st is infection})\\)\n\\(+ \\mathbb{P}(\\text{no outbreak} \\cap \\text{1st is removal})\\)\n\\(= \\mathbb{P}(\\text{no outbreak | 1st is infection}) \\times \\mathbb{P}(\\text{1st is infection})\\)\n\\(+ \\mathbb{P}(\\text{no outbreak | 1st is removal}) \\times \\mathbb{P}(\\text{1st is removal})\\)"
  },
  {
    "objectID": "index.html#first-step-analysis-2-1",
    "href": "index.html#first-step-analysis-2-1",
    "title": "Estimate the risk of outbreaks",
    "section": "First-step analysis (2)",
    "text": "First-step analysis (2)\nLet call:\n\n\\(q_0 = \\mathbb{P}(\\text{no outbreak | 0 infection})\\)\n\\(q_1 = \\mathbb{P}(\\text{no outbreak | 1 infection})\\), this is our starting point\n\\(q_2 = \\mathbb{P}(\\text{no outbreak | 2 infections})\\)"
  },
  {
    "objectID": "index.html#first-step-analysis-3",
    "href": "index.html#first-step-analysis-3",
    "title": "Estimate the risk of outbreaks",
    "section": "First-step analysis (3)",
    "text": "First-step analysis (3)\nLet call:\n\n\\(q_0 = \\mathbb{P}(\\text{no outbreak | 0 infection}) = 1\\)\n\\(q_1 = \\mathbb{P}(\\text{no outbreak | 1 infection})\\)\n\\(q_2 = \\mathbb{P}(\\text{no outbreak | 2 infections})\\)"
  },
  {
    "objectID": "index.html#first-step-analysis-4",
    "href": "index.html#first-step-analysis-4",
    "title": "Estimate the risk of outbreaks",
    "section": "First-step analysis (4)",
    "text": "First-step analysis (4)\n\nOur model is the branching process start from 1 infection, so we are computing \\(q_1\\)."
  },
  {
    "objectID": "index.html#first-step-analysis-5",
    "href": "index.html#first-step-analysis-5",
    "title": "Estimate the risk of outbreaks",
    "section": "First-step analysis (5)",
    "text": "First-step analysis (5)\n\\(\\mathbb{P}\\text{(no outbreak)} =\\)\n\\(= \\mathbb{P}(\\text{no outbreak | 1st is infection}) \\times \\mathbb{P}(\\text{1st is infection})\\)\n\\(+ \\mathbb{P}(\\text{no outbreak | 1st is removal}) \\times \\mathbb{P}(\\text{1st is removal})\\)\n\n\\(\\mathbb{P}\\text{(no outbreak)} = q_1\\)\n\\(\\mathbb{P}(\\text{no outbreak | 1st is infection}) = q_2\\)\n\\(\\mathbb{P}(\\text{1st is infection}) = \\frac{\\beta}{\\beta + \\gamma}\\)\n\\(\\mathbb{P}(\\text{no outbreak | 1st is removal}) = q_0 = 1\\)\n\\(\\mathbb{P}(\\text{1st is removal}) = \\frac{\\gamma}{\\beta + \\gamma}\\)"
  },
  {
    "objectID": "index.html#first-step-analysis-6",
    "href": "index.html#first-step-analysis-6",
    "title": "Estimate the risk of outbreaks",
    "section": "First-step analysis (6)",
    "text": "First-step analysis (6)\n\\[q_1 = \\frac{\\beta}{\\beta + \\gamma} q_2 + \\frac{\\gamma}{\\beta + \\gamma}\\]\nIn branching process, individuals are independently generates new infections, so \\(q_2 = q_1^2\\).\n\\[q_1 = \\frac{\\beta}{\\beta + \\gamma} q_1^2 + \\frac{\\gamma}{\\beta + \\gamma}\\]\nSolve this we also get \\(q_1 = 1\\) or \\(q_1 = \\frac{\\gamma}{\\beta} = \\frac{1}{R_0}\\)."
  },
  {
    "objectID": "index.html#gamma-distributed-infectious-period",
    "href": "index.html#gamma-distributed-infectious-period",
    "title": "Estimate the risk of outbreaks",
    "section": "Gamma distributed infectious period",
    "text": "Gamma distributed infectious period\nUsing constant removal rate assume that the infectious period is exponentially distributed.\n\n\n\n\nflowchart LR\n  S[\"S(t)\"] --βI/N--> I[\"I(t)\"]\n  I --γ--> R[\"R(t)\"]\n\n\n\n\n\n\n\n\nWe split the I compartment into n subcompartments, as a gamma distribution with shape n and rate \\(\\lambda\\) (Erlang distribution) can be thought of as the sum of n exponential distributions each with rate \\(\\lambda\\).\n\n\n\n\nflowchart LR\n  S[\"S(t)\"] --βI/N--> I1[\"I1(t)\"]\n  I1 --γnI1--> I2[\"I2(t)\"]\n  I2 --γnI2--> I3[\"...\"]\n  I3 --> In[\"In(t)\"]\n  In --γnIn--> R[\"R(t)\"]"
  },
  {
    "objectID": "index.html#the-si_nr-model-1",
    "href": "index.html#the-si_nr-model-1",
    "title": "Estimate the risk of outbreaks",
    "section": "The \\(SI_{n}R\\) model (1)",
    "text": "The \\(SI_{n}R\\) model (1)\n\nDefine your stochastic model / branching process: \\(SI_{n}R\\) model\nDerive the offspring distribution\n\n\nThe offspring distribution is also a geometric distribution with success probability \\(\\frac{1}{\\frac{R_0}{n} + 1}\\).\nBecause the host is expected to spend 1/n infectious period in each of the infectious compartments."
  },
  {
    "objectID": "index.html#the-si_nr-model-2",
    "href": "index.html#the-si_nr-model-2",
    "title": "Estimate the risk of outbreaks",
    "section": "The \\(SI_{n}R\\) model (2)",
    "text": "The \\(SI_{n}R\\) model (2)\n\nGet the PGF \\(G_X(s)\\) of the offspring distribution\n\n\n\\(G_X(s) = \\left( \\frac{1}{\\frac{R_0}{n} + 1 - s \\frac{R_0}{n}} \\right)^n\\)\n\n\nSolve \\(G_X(q) = q\\) for the ultimate extinction probability \\(q\\)\n\n\n\\(q = \\left( \\frac{1}{\\frac{R_0}{n} + 1 - q \\frac{R_0}{n}} \\right)^n\\)"
  },
  {
    "objectID": "index.html#the-si_nr-model",
    "href": "index.html#the-si_nr-model",
    "title": "Estimate the risk of outbreaks",
    "section": "The \\(SI_{n}R\\) model",
    "text": "The \\(SI_{n}R\\) model\n\n\nCode\nsolve_q <- function(R0, n){\n  # define the equation\n  f <- function(q) (1 / ((R0 / n) + 1 - q * (R0 / n))^n) - q\n  \n  # use uniroot function to find the root of the equation\n  result <- uniroot(f, lower=0, upper=0.999)$root\n  \n  return(result)\n}\n\nR0 <- 2\nn <- seq(0.001, 5, 0.001)\nq <- numeric(length(n))\n\nfor (i in 1:length(n)){\n  q[i] <- solve_q(R0, n[i])\n}\n\nplot(n, 1-q, type=\"l\", xlab=\"n\", ylab=\"1-q\", \n     xlim = c(0, 5), ylim = c(0, 0.8))"
  }
]